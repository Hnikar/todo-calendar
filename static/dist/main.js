/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={"./src/modules/auth.js":(e,t,o)=>{o.r(t),o.d(t,{Auth:()=>r});var n=o("./src/modules/loader.js"),s=o("./src/modules/domUtils.js");const r=(()=>{function e(){const e=document.getElementById("authForm");if(!e)return console.error("Auth form not found!");e.addEventListener("submit",o),t("login"),document.querySelectorAll("[data-mode]").forEach((e=>e.addEventListener("click",(()=>{t(e.dataset.mode)}))))}function t(e){const t=document.getElementById("nameField"),o=document.querySelector('#authForm button[type="submit"]'),n=document.getElementById("password"),r=document.querySelectorAll(".tab");t&&(t.style.display="register"===e?"block":"none",document.getElementById("name").required="register"===e),r.forEach((t=>t.classList.toggle("active",t.dataset.mode===e))),o&&(o.textContent="login"===e?"Login":"Register"),n&&(n.autocomplete="login"===e?"current-password":"new-password"),s.DomUtils.clearMessages()}async function o(e){e.preventDefault(),s.DomUtils.clearMessages(),n.Loader.toggle(!0);const o=document.querySelector('[data-mode="login"]').classList.contains("active"),a=o?"/api/login":"/api/register",c={email:r("email"),password:r("password")};o||(c.name=r("name"));try{!function(e,t){const o=[];if(e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||o.push("Invalid email format."):o.push("Email is required."),e.password?e.password.length<8&&!t&&o.push("Password must be at least 8 characters."):o.push("Password is required."),t||e.name&&!(e.name.length<2)||o.push("Name must be at least 2 characters."),o.length)throw new Error(o.join("\n"))}(c,o);const e=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(c)});await async function(e,o){const n=e.headers.get("content-type")?.includes("application/json"),r=n?await e.json():{message:await e.text()};if(!e.ok)throw new Error(r.error||`Error: ${e.status}`);o?(localStorage.setItem("user",JSON.stringify(r.user||{})),window.location.href="/app"):(s.DomUtils.showSuccess(r.message||"Registration successful. Please login."),t("login"),["email","password","name"].forEach((e=>{const t=document.getElementById(e);t&&(t.value="")})))}(e,o)}catch(e){s.DomUtils.showError(e.message||"Unexpected error during submission.")}finally{n.Loader.toggle(!1)}}function r(e){const t=document.getElementById(e);return t?t.value.trim():""}return document.addEventListener("DOMContentLoaded",(()=>{"/login"===window.location.pathname&&(e(),function(){const e=new URLSearchParams(location.search).get("reason"),t={unauthenticated:"Please log in to access the application.",invalid_token:"Session expired. Please log in again.",bad_token_claims:"Session data issue. Please log in again."};e&&t[e]&&s.DomUtils.showError(t[e]),history.replaceState(null,"",location.pathname)}())})),{init:e}})()},"./src/modules/domUtils.js":(e,t,o)=>{o.r(t),o.d(t,{DomUtils:()=>n});const n=(()=>{function e(){const e=document.getElementById("messageContainer");e&&(e.innerHTML=""),document.querySelectorAll(".error-message, .success-message").forEach((t=>{t.parentNode!==e&&t.remove()}))}function t(t,o="error"){e();const n=document.createElement("div");n.className="error"===o?"error-message":"success-message",t.split("\n").forEach((e=>{const t=document.createElement("p");t.textContent=e,n.appendChild(t)}));const s=document.getElementById("messageContainer");if(s)s.appendChild(n);else{const e=document.getElementById("authForm");e?e.parentNode.insertBefore(n,e):document.body.prepend(n)}}return{clearMessages:e,showError:e=>t(e,"error"),showSuccess:e=>t(e,"success")}})()},"./src/modules/events.js":(e,t,o)=>{o.r(t),o.d(t,{Events:()=>s});var n=o("./src/modules/loader.js");const s={fetchAndDisplay:async function(){const e=document.getElementById("eventsOutput");if(e){e.innerHTML="Loading events...",n.Loader.toggle(!0);try{const t=await fetch("/api/events",{method:"GET",headers:{Accept:"application/json"}});if(!t.ok){const e=await t.json().catch((()=>({})));throw new Error(e.error||`HTTP error! Status: ${t.status}`)}const o=await t.json();e.innerHTML=o.length?"<h4>Received Events:</h4><pre>"+JSON.stringify(o,null,2)+"</pre>":"No events found for your account."}catch(t){console.error("Error fetching events:",t),e.innerHTML=`<p class="api-error-message">Error loading events: ${t.message}</p>`}finally{n.Loader.toggle(!1)}}}}},"./src/modules/loader.js":(e,t,o)=>{o.r(t),o.d(t,{Loader:()=>n});const n={toggle:function(e){let t=document.getElementById("loader");!t&&e&&(t=function(){const e=document.createElement("div");return e.id="loader",e.className="loader",e.innerHTML='<div class="spinner"></div>',document.body.appendChild(e),e}()),t&&(t.style.display=e?"flex":"none")}}},"./src/modules/user.js":(e,t,o)=>{o.r(t),o.d(t,{User:()=>r});var n=o("./src/modules/loader.js"),s=o("./src/modules/domUtils.js");const r=(()=>{async function e(){console.log("Attempting logout..."),n.Loader.toggle(!0);try{const e=await fetch("/api/logout",{method:"POST",headers:{Accept:"application/json"}}),t=await e.json().catch((()=>({})));if(!e.ok)throw new Error(t.error||`Logout failed with status: ${e.status}`);console.log("Logout successful via API.")}catch(e){console.error("Logout API call failed:",e),s.DomUtils.showError("Could not properly log out. Clear cookies manually if needed.")}finally{localStorage.removeItem("user"),n.Loader.toggle(!1),window.location.href="/login"}}return{logout:e,displayUserData:function(){const t=localStorage.getItem("user");if(!t)return e();try{const e=JSON.parse(t).name||"User",o=document.getElementById("user-name-display");o&&(o.textContent=e)}catch(t){console.error("Invalid user data in localStorage."),e()}}}})()}},o={};function n(e){var s=o[e];if(void 0!==s)return s.exports;var r=o[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{n.r(s);var t=n("./src/modules/user.js"),o=n("./src/modules/events.js");n("./src/modules/auth.js"),document.addEventListener("DOMContentLoaded",(()=>{"/app"===window.location.pathname&&t.User.displayUserData();const n=document.getElementById("btn-logout");n&&n.addEventListener("click",t.User.logout);const s=document.getElementById("fetchEventsBtn");s&&s.addEventListener("click",(()=>{e.preventDefault(),o.Events.fetchAndDisplay})),console.log("Main app initialized.")}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkUsSUFBakJELEVBQ0gsT0FBT0EsRUFBYUUsUUFHckIsSUFBSUMsRUFBU04sRUFBeUJFLEdBQVksQ0FHakRHLFFBQVMsQ0FBQyxHQU9YLE9BSEFFLEVBQW9CTCxHQUFVSSxFQUFRQSxFQUFPRCxRQUFTSixHQUcvQ0ssRUFBT0QsT0FDZixDQ3JCQUosRUFBb0JPLEVBQUksQ0FBQ0gsRUFBU0ksS0FDakMsSUFBSSxJQUFJQyxLQUFPRCxFQUNYUixFQUFvQlUsRUFBRUYsRUFBWUMsS0FBU1QsRUFBb0JVLEVBQUVOLEVBQVNLLElBQzVFRSxPQUFPQyxlQUFlUixFQUFTSyxFQUFLLENBQUVJLFlBQVksRUFBTWpGLElBQUs0RSxFQUFXQyxJQUUxRSxFQ05EVCxFQUFvQlUsRUFBSSxDQUFDSSxFQUFLQyxJQUFVSixPQUFPSyxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxHQ0NsRmYsRUFBb0JtQixFQUFLZixJQUNILG9CQUFYZ0IsUUFBMEJBLE9BQU9DLGFBQzFDVixPQUFPQyxlQUFlUixFQUFTZ0IsT0FBT0MsWUFBYSxDQUFFekUsTUFBTyxXQUU3RCtELE9BQU9DLGVBQWVSLEVBQVMsYUFBYyxDQUFFeEQsT0FBTyxHQUFPLG1IQ0Q5RHZFLFNBQVNJLGlCQUFpQixvQkFBb0IsS0FDWCxTQUE3QjZELE9BQU9DLFNBQVNVLFVBQ2xCLEVBQUFvQyxLQUFLSSxrQkFFUCxNQUFNNkIsRUFBWWpKLFNBQVNDLGVBQWUsY0FDdENnSixHQUFXQSxFQUFVN0ksaUJBQWlCLFFBQVMsRUFBQTRHLEtBQUtDLFFBRXhELE1BQU1pQyxFQUFZbEosU0FBU0MsZUFBZSxrQkFDdENpSixHQUNGQSxFQUFVOUksaUJBQWlCLFNBQVMsS0FDbEN1QixFQUFFQyxpQkFDRixFQUFBMkUsT0FBT0MsZUFBZSxJQUcxQnRHLFFBQVFnSCxJQUFJLHdCQUF3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3N0YXRpYy8uL3NyYy9tb2R1bGVzL2F1dGguanMiLCJ3ZWJwYWNrOi8vc3RhdGljLy4vc3JjL21vZHVsZXMvZG9tVXRpbHMuanMiLCJ3ZWJwYWNrOi8vc3RhdGljLy4vc3JjL21vZHVsZXMvZXZlbnRzLmpzIiwid2VicGFjazovL3N0YXRpYy8uL3NyYy9tb2R1bGVzL2xvYWRlci5qcyIsIndlYnBhY2s6Ly9zdGF0aWMvLi9zcmMvbW9kdWxlcy91c2VyLmpzIiwid2VicGFjazovL3N0YXRpYy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zdGF0aWMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3N0YXRpYy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3N0YXRpYy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3N0YXRpYy8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMb2FkZXIgfSBmcm9tIFwiLi9sb2FkZXIuanNcIjtcclxuaW1wb3J0IHsgRG9tVXRpbHMgfSBmcm9tIFwiLi9kb21VdGlscy5qc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IEF1dGggPSAoKCkgPT4ge1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcclxuICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09IFwiL2xvZ2luXCIpIHtcclxuICAgICAgaW5pdCgpO1xyXG4gICAgICBjaGVja1JlZGlyZWN0UmVhc29uKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdXRoRm9ybVwiKTtcclxuICAgIGlmICghZm9ybSkgcmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJBdXRoIGZvcm0gbm90IGZvdW5kIVwiKTtcclxuXHJcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlU3VibWl0KTtcclxuICAgIHN3aXRjaE1vZGUoXCJsb2dpblwiKTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1tb2RlXVwiKS5mb3JFYWNoKCh0YWIpID0+XHJcbiAgICAgIHRhYi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHN3aXRjaE1vZGUodGFiLmRhdGFzZXQubW9kZSk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc3dpdGNoTW9kZShtb2RlKSB7XHJcbiAgICBjb25zdCBuYW1lRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVGaWVsZFwiKTtcclxuICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdXRoRm9ybSBidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG4gICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGFzc3dvcmRcIik7XHJcbiAgICBjb25zdCB0YWJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YWJcIik7XHJcblxyXG4gICAgaWYgKG5hbWVGaWVsZCkge1xyXG4gICAgICBuYW1lRmllbGQuc3R5bGUuZGlzcGxheSA9IG1vZGUgPT09IFwicmVnaXN0ZXJcIiA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVcIikucmVxdWlyZWQgPSBtb2RlID09PSBcInJlZ2lzdGVyXCI7XHJcbiAgICB9XHJcbiAgICB0YWJzLmZvckVhY2goKHRhYikgPT5cclxuICAgICAgdGFiLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIiwgdGFiLmRhdGFzZXQubW9kZSA9PT0gbW9kZSlcclxuICAgICk7XHJcbiAgICBpZiAoc3VibWl0QnRuKVxyXG4gICAgICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBtb2RlID09PSBcImxvZ2luXCIgPyBcIkxvZ2luXCIgOiBcIlJlZ2lzdGVyXCI7XHJcbiAgICBpZiAocGFzc3dvcmRJbnB1dClcclxuICAgICAgcGFzc3dvcmRJbnB1dC5hdXRvY29tcGxldGUgPVxyXG4gICAgICAgIG1vZGUgPT09IFwibG9naW5cIiA/IFwiY3VycmVudC1wYXNzd29yZFwiIDogXCJuZXctcGFzc3dvcmRcIjtcclxuXHJcbiAgICBEb21VdGlscy5jbGVhck1lc3NhZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVTdWJtaXQoZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgRG9tVXRpbHMuY2xlYXJNZXNzYWdlcygpO1xyXG4gICAgTG9hZGVyLnRvZ2dsZSh0cnVlKTtcclxuXHJcbiAgICBjb25zdCBpc0xvZ2luID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW1vZGU9XCJsb2dpblwiXScpXHJcbiAgICAgIC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIik7XHJcbiAgICBjb25zdCB1cmwgPSBpc0xvZ2luID8gXCIvYXBpL2xvZ2luXCIgOiBcIi9hcGkvcmVnaXN0ZXJcIjtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0ge1xyXG4gICAgICBlbWFpbDogZ2V0VmFsKFwiZW1haWxcIiksXHJcbiAgICAgIHBhc3N3b3JkOiBnZXRWYWwoXCJwYXNzd29yZFwiKSxcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCFpc0xvZ2luKSBmb3JtRGF0YS5uYW1lID0gZ2V0VmFsKFwibmFtZVwiKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICB2YWxpZGF0ZShmb3JtRGF0YSwgaXNMb2dpbik7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShmb3JtRGF0YSksXHJcbiAgICAgIH0pO1xyXG4gICAgICBhd2FpdCBoYW5kbGVSZXNwb25zZShyZXNwb25zZSwgaXNMb2dpbik7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgRG9tVXRpbHMuc2hvd0Vycm9yKGVyci5tZXNzYWdlIHx8IFwiVW5leHBlY3RlZCBlcnJvciBkdXJpbmcgc3VibWlzc2lvbi5cIik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBMb2FkZXIudG9nZ2xlKGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldFZhbChpZCkge1xyXG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICByZXR1cm4gZWwgPyBlbC52YWx1ZS50cmltKCkgOiBcIlwiO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGUoZGF0YSwgaXNMb2dpbikge1xyXG4gICAgY29uc3QgZXJyb3JzID0gW107XHJcbiAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XHJcblxyXG4gICAgaWYgKCFkYXRhLmVtYWlsKSBlcnJvcnMucHVzaChcIkVtYWlsIGlzIHJlcXVpcmVkLlwiKTtcclxuICAgIGVsc2UgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZGF0YS5lbWFpbCkpIGVycm9ycy5wdXNoKFwiSW52YWxpZCBlbWFpbCBmb3JtYXQuXCIpO1xyXG4gICAgaWYgKCFkYXRhLnBhc3N3b3JkKSBlcnJvcnMucHVzaChcIlBhc3N3b3JkIGlzIHJlcXVpcmVkLlwiKTtcclxuICAgIGVsc2UgaWYgKGRhdGEucGFzc3dvcmQubGVuZ3RoIDwgOCAmJiAhaXNMb2dpbilcclxuICAgICAgZXJyb3JzLnB1c2goXCJQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycy5cIik7XHJcbiAgICBpZiAoIWlzTG9naW4gJiYgKCFkYXRhLm5hbWUgfHwgZGF0YS5uYW1lLmxlbmd0aCA8IDIpKVxyXG4gICAgICBlcnJvcnMucHVzaChcIk5hbWUgbXVzdCBiZSBhdCBsZWFzdCAyIGNoYXJhY3RlcnMuXCIpO1xyXG5cclxuICAgIGlmIChlcnJvcnMubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzLmpvaW4oXCJcXG5cIikpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzcG9uc2UsIGlzTG9naW4pIHtcclxuICAgIGNvbnN0IGlzSnNvbiA9IHJlc3BvbnNlLmhlYWRlcnNcclxuICAgICAgLmdldChcImNvbnRlbnQtdHlwZVwiKVxyXG4gICAgICA/LmluY2x1ZGVzKFwiYXBwbGljYXRpb24vanNvblwiKTtcclxuICAgIGNvbnN0IGRhdGEgPSBpc0pzb25cclxuICAgICAgPyBhd2FpdCByZXNwb25zZS5qc29uKClcclxuICAgICAgOiB7IG1lc3NhZ2U6IGF3YWl0IHJlc3BvbnNlLnRleHQoKSB9O1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLmVycm9yIHx8IGBFcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XHJcblxyXG4gICAgaWYgKGlzTG9naW4pIHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ1c2VyXCIsIEpTT04uc3RyaW5naWZ5KGRhdGEudXNlciB8fCB7fSkpO1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2FwcFwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgRG9tVXRpbHMuc2hvd1N1Y2Nlc3MoXHJcbiAgICAgICAgZGF0YS5tZXNzYWdlIHx8IFwiUmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwuIFBsZWFzZSBsb2dpbi5cIlxyXG4gICAgICApO1xyXG4gICAgICBzd2l0Y2hNb2RlKFwibG9naW5cIik7XHJcbiAgICAgIFtcImVtYWlsXCIsIFwicGFzc3dvcmRcIiwgXCJuYW1lXCJdLmZvckVhY2goKGlkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICAgICAgaWYgKGVsKSBlbC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2hlY2tSZWRpcmVjdFJlYXNvbigpIHtcclxuICAgIGNvbnN0IHJlYXNvbiA9IG5ldyBVUkxTZWFyY2hQYXJhbXMobG9jYXRpb24uc2VhcmNoKS5nZXQoXCJyZWFzb25cIik7XHJcbiAgICBjb25zdCBtZXNzYWdlcyA9IHtcclxuICAgICAgdW5hdXRoZW50aWNhdGVkOiBcIlBsZWFzZSBsb2cgaW4gdG8gYWNjZXNzIHRoZSBhcHBsaWNhdGlvbi5cIixcclxuICAgICAgaW52YWxpZF90b2tlbjogXCJTZXNzaW9uIGV4cGlyZWQuIFBsZWFzZSBsb2cgaW4gYWdhaW4uXCIsXHJcbiAgICAgIGJhZF90b2tlbl9jbGFpbXM6IFwiU2Vzc2lvbiBkYXRhIGlzc3VlLiBQbGVhc2UgbG9nIGluIGFnYWluLlwiLFxyXG4gICAgfTtcclxuICAgIGlmIChyZWFzb24gJiYgbWVzc2FnZXNbcmVhc29uXSkgRG9tVXRpbHMuc2hvd0Vycm9yKG1lc3NhZ2VzW3JlYXNvbl0pO1xyXG4gICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgXCJcIiwgbG9jYXRpb24ucGF0aG5hbWUpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgaW5pdCB9O1xyXG59KSgpO1xyXG4iLCJleHBvcnQgY29uc3QgRG9tVXRpbHMgPSAoKCkgPT4ge1xyXG4gIGZ1bmN0aW9uIGNsZWFyTWVzc2FnZXMoKSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lc3NhZ2VDb250YWluZXJcIik7XHJcbiAgICBpZiAoY29udGFpbmVyKSBjb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFwiLmVycm9yLW1lc3NhZ2UsIC5zdWNjZXNzLW1lc3NhZ2VcIilcclxuICAgICAgLmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgICAgaWYgKGVsLnBhcmVudE5vZGUgIT09IGNvbnRhaW5lcikgZWwucmVtb3ZlKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2hvd01lc3NhZ2UobWVzc2FnZSwgdHlwZSA9IFwiZXJyb3JcIikge1xyXG4gICAgY2xlYXJNZXNzYWdlcygpO1xyXG4gICAgY29uc3QgbWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgbWVzc2FnZUVsZW1lbnQuY2xhc3NOYW1lID1cclxuICAgICAgdHlwZSA9PT0gXCJlcnJvclwiID8gXCJlcnJvci1tZXNzYWdlXCIgOiBcInN1Y2Nlc3MtbWVzc2FnZVwiO1xyXG4gICAgbWVzc2FnZS5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lKSA9PiB7XHJcbiAgICAgIGNvbnN0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgcC50ZXh0Q29udGVudCA9IGxpbmU7XHJcbiAgICAgIG1lc3NhZ2VFbGVtZW50LmFwcGVuZENoaWxkKHApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZXNzYWdlQ29udGFpbmVyXCIpO1xyXG4gICAgaWYgKGNvbnRhaW5lcikge1xyXG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobWVzc2FnZUVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXV0aEZvcm1cIik7XHJcbiAgICAgIGZvcm1cclxuICAgICAgICA/IGZvcm0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobWVzc2FnZUVsZW1lbnQsIGZvcm0pXHJcbiAgICAgICAgOiBkb2N1bWVudC5ib2R5LnByZXBlbmQobWVzc2FnZUVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNsZWFyTWVzc2FnZXMsXHJcbiAgICBzaG93RXJyb3I6IChtc2cpID0+IHNob3dNZXNzYWdlKG1zZywgXCJlcnJvclwiKSxcclxuICAgIHNob3dTdWNjZXNzOiAobXNnKSA9PiBzaG93TWVzc2FnZShtc2csIFwic3VjY2Vzc1wiKSxcclxuICB9O1xyXG59KSgpO1xyXG4iLCJpbXBvcnQgeyBMb2FkZXIgfSBmcm9tIFwiLi9sb2FkZXIuanNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBFdmVudHMgPSAoKCkgPT4ge1xyXG4gIGFzeW5jIGZ1bmN0aW9uIGZldGNoQW5kRGlzcGxheSgpIHtcclxuICAgIGNvbnN0IG91dHB1dERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXZlbnRzT3V0cHV0XCIpO1xyXG4gICAgaWYgKCFvdXRwdXREaXYpIHJldHVybjtcclxuXHJcbiAgICBvdXRwdXREaXYuaW5uZXJIVE1MID0gXCJMb2FkaW5nIGV2ZW50cy4uLlwiO1xyXG4gICAgTG9hZGVyLnRvZ2dsZSh0cnVlKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFwiL2FwaS9ldmVudHNcIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgIGVycm9yRGF0YS5lcnJvciB8fCBgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgZXZlbnRzID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICBvdXRwdXREaXYuaW5uZXJIVE1MID0gZXZlbnRzLmxlbmd0aFxyXG4gICAgICAgID8gXCI8aDQ+UmVjZWl2ZWQgRXZlbnRzOjwvaDQ+PHByZT5cIiArXHJcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeShldmVudHMsIG51bGwsIDIpICtcclxuICAgICAgICAgIFwiPC9wcmU+XCJcclxuICAgICAgICA6IFwiTm8gZXZlbnRzIGZvdW5kIGZvciB5b3VyIGFjY291bnQuXCI7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgZXZlbnRzOlwiLCBlcnJvcik7XHJcbiAgICAgIG91dHB1dERpdi5pbm5lckhUTUwgPSBgPHAgY2xhc3M9XCJhcGktZXJyb3ItbWVzc2FnZVwiPkVycm9yIGxvYWRpbmcgZXZlbnRzOiAke2Vycm9yLm1lc3NhZ2V9PC9wPmA7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBMb2FkZXIudG9nZ2xlKGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7IGZldGNoQW5kRGlzcGxheSB9O1xyXG59KSgpO1xyXG4iLCJleHBvcnQgY29uc3QgTG9hZGVyID0gKCgpID0+IHtcclxuICBmdW5jdGlvbiB0b2dnbGUoc2hvdykge1xyXG4gICAgbGV0IGxvYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9hZGVyXCIpO1xyXG4gICAgaWYgKCFsb2FkZXIgJiYgc2hvdykgbG9hZGVyID0gY3JlYXRlKCk7XHJcbiAgICBpZiAobG9hZGVyKSBsb2FkZXIuc3R5bGUuZGlzcGxheSA9IHNob3cgPyBcImZsZXhcIiA6IFwibm9uZVwiO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlKCkge1xyXG4gICAgY29uc3QgbG9hZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGxvYWRlci5pZCA9IFwibG9hZGVyXCI7XHJcbiAgICBsb2FkZXIuY2xhc3NOYW1lID0gXCJsb2FkZXJcIjtcclxuICAgIGxvYWRlci5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cInNwaW5uZXJcIj48L2Rpdj4nO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsb2FkZXIpO1xyXG4gICAgcmV0dXJuIGxvYWRlcjtcclxuICB9XHJcblxyXG4gIHJldHVybiB7IHRvZ2dsZSB9O1xyXG59KSgpO1xyXG4iLCJpbXBvcnQgeyBMb2FkZXIgfSBmcm9tIFwiLi9sb2FkZXIuanNcIjtcclxuaW1wb3J0IHsgRG9tVXRpbHMgfSBmcm9tIFwiLi9kb21VdGlscy5qc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IFVzZXIgPSAoKCkgPT4ge1xyXG4gIGFzeW5jIGZ1bmN0aW9uIGxvZ291dCgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiQXR0ZW1wdGluZyBsb2dvdXQuLi5cIik7XHJcbiAgICBMb2FkZXIudG9nZ2xlKHRydWUpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcIi9hcGkvbG9nb3V0XCIsIHtcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgZGF0YS5lcnJvciB8fCBgTG9nb3V0IGZhaWxlZCB3aXRoIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YFxyXG4gICAgICAgICk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiTG9nb3V0IHN1Y2Nlc3NmdWwgdmlhIEFQSS5cIik7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTG9nb3V0IEFQSSBjYWxsIGZhaWxlZDpcIiwgZXJyb3IpO1xyXG4gICAgICBEb21VdGlscy5zaG93RXJyb3IoXHJcbiAgICAgICAgXCJDb3VsZCBub3QgcHJvcGVybHkgbG9nIG91dC4gQ2xlYXIgY29va2llcyBtYW51YWxseSBpZiBuZWVkZWQuXCJcclxuICAgICAgKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidXNlclwiKTtcclxuICAgICAgTG9hZGVyLnRvZ2dsZShmYWxzZSk7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvbG9naW5cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGRpc3BsYXlVc2VyRGF0YSgpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhU3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ1c2VyXCIpO1xyXG4gICAgaWYgKCF1c2VyRGF0YVN0cmluZykgcmV0dXJuIGxvZ291dCgpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlKHVzZXJEYXRhU3RyaW5nKTtcclxuICAgICAgY29uc3QgdXNlck5hbWUgPSB1c2VyRGF0YS5uYW1lIHx8IFwiVXNlclwiO1xyXG4gICAgICBjb25zdCB1c2VyTmFtZURpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXItbmFtZS1kaXNwbGF5XCIpO1xyXG4gICAgICBpZiAodXNlck5hbWVEaXNwbGF5KSB1c2VyTmFtZURpc3BsYXkudGV4dENvbnRlbnQgPSB1c2VyTmFtZTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkludmFsaWQgdXNlciBkYXRhIGluIGxvY2FsU3RvcmFnZS5cIik7XHJcbiAgICAgIGxvZ291dCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgbG9nb3V0LCBkaXNwbGF5VXNlckRhdGEgfTtcclxufSkoKTtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJpbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4vbW9kdWxlcy91c2VyLmpzXCI7XHJcbmltcG9ydCB7IEV2ZW50cyB9IGZyb20gXCIuL21vZHVsZXMvZXZlbnRzLmpzXCI7XHJcbmltcG9ydCB7IEF1dGggfSBmcm9tIFwiLi9tb2R1bGVzL2F1dGguanNcIjtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcclxuICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSBcIi9hcHBcIikge1xyXG4gICAgVXNlci5kaXNwbGF5VXNlckRhdGEoKTtcclxuICB9XHJcbiAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tbG9nb3V0XCIpO1xyXG4gIGlmIChsb2dvdXRCdG4pIGxvZ291dEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgVXNlci5sb2dvdXQpO1xyXG5cclxuICBjb25zdCBldmVudHNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZldGNoRXZlbnRzQnRuXCIpO1xyXG4gIGlmIChldmVudHNCdG4pXHJcbiAgICBldmVudHNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBFdmVudHMuZmV0Y2hBbmREaXNwbGF5O1xyXG4gICAgfSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiTWFpbiBhcHAgaW5pdGlhbGl6ZWQuXCIpO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbIkF1dGgiLCJpbml0IiwiZm9ybSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25zb2xlIiwiZXJyb3IiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlU3VibWl0Iiwic3dpdGNoTW9kZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwidGFiIiwiZGF0YXNldCIsIm1vZGUiLCJuYW1lRmllbGQiLCJzdWJtaXRCdG4iLCJxdWVyeVNlbGVjdG9yIiwicGFzc3dvcmRJbnB1dCIsInRhYnMiLCJzdHlsZSIsImRpc3BsYXkiLCJyZXF1aXJlZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInRleHRDb250ZW50IiwiYXV0b2NvbXBsZXRlIiwiRG9tVXRpbHMiLCJjbGVhck1lc3NhZ2VzIiwiYXN5bmMiLCJlIiwicHJldmVudERlZmF1bHQiLCJMb2FkZXIiLCJpc0xvZ2luIiwiY29udGFpbnMiLCJ1cmwiLCJmb3JtRGF0YSIsImVtYWlsIiwiZ2V0VmFsIiwicGFzc3dvcmQiLCJuYW1lIiwiZGF0YSIsImVycm9ycyIsInRlc3QiLCJwdXNoIiwibGVuZ3RoIiwiRXJyb3IiLCJqb2luIiwidmFsaWRhdGUiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkFjY2VwdCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaXNKc29uIiwiZ2V0IiwiaW5jbHVkZXMiLCJqc29uIiwibWVzc2FnZSIsInRleHQiLCJvayIsInN0YXR1cyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJ1c2VyIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwic2hvd1N1Y2Nlc3MiLCJpZCIsImVsIiwidmFsdWUiLCJoYW5kbGVSZXNwb25zZSIsImVyciIsInNob3dFcnJvciIsInRyaW0iLCJwYXRobmFtZSIsInJlYXNvbiIsIlVSTFNlYXJjaFBhcmFtcyIsInNlYXJjaCIsIm1lc3NhZ2VzIiwidW5hdXRoZW50aWNhdGVkIiwiaW52YWxpZF90b2tlbiIsImJhZF90b2tlbl9jbGFpbXMiLCJoaXN0b3J5IiwicmVwbGFjZVN0YXRlIiwiY2hlY2tSZWRpcmVjdFJlYXNvbiIsImNvbnRhaW5lciIsImlubmVySFRNTCIsInBhcmVudE5vZGUiLCJyZW1vdmUiLCJzaG93TWVzc2FnZSIsInR5cGUiLCJtZXNzYWdlRWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzcGxpdCIsImxpbmUiLCJwIiwiYXBwZW5kQ2hpbGQiLCJpbnNlcnRCZWZvcmUiLCJwcmVwZW5kIiwibXNnIiwiRXZlbnRzIiwiZmV0Y2hBbmREaXNwbGF5Iiwib3V0cHV0RGl2IiwiZXJyb3JEYXRhIiwiY2F0Y2giLCJldmVudHMiLCJzaG93IiwibG9hZGVyIiwiY3JlYXRlIiwiVXNlciIsImxvZ291dCIsImxvZyIsInJlbW92ZUl0ZW0iLCJkaXNwbGF5VXNlckRhdGEiLCJ1c2VyRGF0YVN0cmluZyIsImdldEl0ZW0iLCJ1c2VyTmFtZSIsInBhcnNlIiwidXNlck5hbWVEaXNwbGF5IiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwibG9nb3V0QnRuIiwiZXZlbnRzQnRuIl0sInNvdXJjZVJvb3QiOiIifQ==